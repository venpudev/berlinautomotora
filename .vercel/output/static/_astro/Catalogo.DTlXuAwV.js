import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.BJfUAbRs.js";import{f as h,V as T,a as F}from"./ProductCard.DoVZbuAH.js";const y=n=>n?parseInt(n.replace(/,/g,"")):0,j=12;function P(){const[n,v]=r.useState([]),[R,w]=r.useState(!0),[o,x]=r.useState(1),[u,M]=r.useState(!1),[s,b]=r.useState({brand:"",priceRange:{min:0,max:1e8},fuelType:"",transmission:"",milesRange:{min:0,max:5e5},available:null});r.useEffect(()=>{(async()=>{try{const l=await F();v(l)}catch(l){console.error("Error loading vehicles:",l)}finally{w(!1)}})()},[]);const C=r.useMemo(()=>[...new Set(n.map(a=>a.brand))].sort(),[n]),i=r.useMemo(()=>{if(n.length===0)return{min:0,max:1e8};const a=n.map(l=>y(l.price)).filter(l=>!isNaN(l)&&l>0);return a.length===0?{min:0,max:1e8}:{min:Math.min(...a),max:Math.max(...a)}},[n]),t=r.useMemo(()=>{if(n.length===0)return{min:0,max:5e5};const a=n.map(l=>l.miles).filter(l=>!isNaN(l));return{min:Math.min(...a),max:Math.max(...a)}},[n]);r.useEffect(()=>{n.length>0&&b(a=>({...a,priceRange:{min:a.priceRange.min===0||a.priceRange.min===1e8?i.min:a.priceRange.min,max:a.priceRange.max===1e8||a.priceRange.max===0?i.max:a.priceRange.max},milesRange:{min:a.milesRange.min===0||a.milesRange.min===5e5?t.min:a.milesRange.min,max:a.milesRange.max===5e5||a.milesRange.max===0?t.max:a.milesRange.max}}))},[n.length,i.min,i.max,t.min,t.max]);const p=r.useMemo(()=>n.filter(a=>{const l=y(a.price);return isNaN(l)||l<=0?!1:(s.brand===""||a.brand===s.brand)&&l>=s.priceRange.min&&l<=s.priceRange.max&&(s.fuelType===""||a.fuelType===s.fuelType)&&(s.transmission===""||a.transmission===s.transmission)&&a.miles>=s.milesRange.min&&a.miles<=s.milesRange.max&&(s.available===null||a.available===s.available)}),[n,s]),d=Math.ceil(p.length/j),f=(o-1)*j,N=p.slice(f,f+j),m=(a,l)=>{b(c=>({...c,[a]:l})),x(1)},k=()=>{b({brand:"",priceRange:{min:i.min,max:i.max},fuelType:"",transmission:"",milesRange:{min:t.min,max:t.max},available:null}),x(1)},g=a=>new Intl.NumberFormat("es-CL").format(a);return R?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-red-400"})}):e.jsxs("div",{className:"md:w-7xl mx-auto px-4 py-24",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-dark mb-4",children:"Catálogo de Vehículos"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-gray-400",children:[p.length," vehículos encontrados"]}),e.jsx("button",{onClick:()=>M(!u),className:"lg:hidden bg-orange-600 text-white px-4 py-2 rounded-lg font-semibold",children:u?"Ocultar Filtros":"Mostrar Filtros"})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:`lg:w-1/4 ${u?"block":"hidden lg:block"}`,children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-800 sticky top-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Filtros"}),e.jsx("button",{onClick:k,className:"text-sm text-red-400 hover:text-red-300",children:"Limpiar todo"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Disponibilidad"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center text-gray-300",children:[e.jsx("input",{type:"radio",name:"availability",checked:s.available===null,onChange:()=>m("available",null),className:"mr-2"}),"Todos"]}),e.jsxs("label",{className:"flex items-center text-gray-300",children:[e.jsx("input",{type:"radio",name:"availability",checked:s.available===!0,onChange:()=>m("available",!0),className:"mr-2"}),"Disponibles"]}),e.jsxs("label",{className:"flex items-center text-gray-300",children:[e.jsx("input",{type:"radio",name:"availability",checked:s.available===!1,onChange:()=>m("available",!1),className:"mr-2"}),"Vendidos"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Marca"}),e.jsxs("select",{value:s.brand,onChange:a=>m("brand",a.target.value),className:"w-full bg-gray-800 text-white border border-gray-700 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Todas las marcas"}),C.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Precio"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["Mínimo: ",h(s.priceRange.min)]}),e.jsx("input",{type:"range",min:i.min,max:i.max,step:"1000000",value:s.priceRange.min,onChange:a=>{const l=parseInt(a.target.value);m("priceRange",{...s.priceRange,min:l})},className:"w-full accent-red-400"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["Máximo: ",h(s.priceRange.max)]}),e.jsx("input",{type:"range",min:i.min,max:i.max,step:"1000000",value:s.priceRange.max,onChange:a=>{const l=parseInt(a.target.value);m("priceRange",{...s.priceRange,max:l})},className:"w-full accent-red-400"})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Rango disponible: ",h(i.min)," -"," ",h(i.max)]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Combustible"}),e.jsxs("select",{value:s.fuelType,onChange:a=>m("fuelType",a.target.value),className:"w-full bg-gray-800 text-white border border-gray-700 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"Bencina",children:"Bencina"}),e.jsx("option",{value:"Diesel",children:"Diesel"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Transmisión"}),e.jsxs("select",{value:s.transmission,onChange:a=>m("transmission",a.target.value),className:"w-full bg-gray-800 text-white border border-gray-700 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Todas"}),e.jsx("option",{value:"Automático",children:"Automático"}),e.jsx("option",{value:"Manual",children:"Manual"}),e.jsx("option",{value:"Mecánico",children:"Mecánico"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Kilometraje"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["Mínimo: ",g(s.milesRange.min)," km"]}),e.jsx("input",{type:"range",min:t.min,max:t.max,step:"10000",value:s.milesRange.min,onChange:a=>m("milesRange",{...s.milesRange,min:parseInt(a.target.value)}),className:"w-full accent-red-400"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["Máximo: ",g(s.milesRange.max)," km"]}),e.jsx("input",{type:"range",min:t.min,max:t.max,step:"10000",value:s.milesRange.max,onChange:a=>m("milesRange",{...s.milesRange,max:parseInt(a.target.value)}),className:"w-full accent-red-400"})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Rango disponible: ",g(t.min)," -"," ",g(t.max)," km"]})]})]})]})}),e.jsx("div",{className:"lg:w-3/4",children:N.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400 text-lg",children:"No se encontraron vehículos con los filtros seleccionados."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 mb-8",children:N.map(a=>e.jsx(T,{vehicle:a},a.id))}),d>1&&e.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[e.jsx("button",{onClick:()=>x(a=>Math.max(a-1,1)),disabled:o===1,className:"px-4 py-2 bg-gray-800 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-700",children:"Anterior"}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:Math.min(5,d)},(a,l)=>{let c;return d<=5||o<=3?c=l+1:o>=d-2?c=d-4+l:c=o-2+l,e.jsx("button",{onClick:()=>x(c),className:`px-3 py-2 rounded-lg ${o===c?"bg-red-400 text-black font-bold":"bg-gray-800 text-white hover:bg-gray-700"}`,children:c},c)})}),e.jsx("button",{onClick:()=>x(a=>Math.min(a+1,d)),disabled:o===d,className:"px-4 py-2 bg-gray-800 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-700",children:"Siguiente"})]})]})})]})]})}export{P as Catalogo};
